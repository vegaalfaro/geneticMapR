<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Flexible Genotype Format Converter (Supports Polyploid Dosage) — formater_flex • geneticMapR</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Flexible Genotype Format Converter (Supports Polyploid Dosage) — formater_flex"><meta name="description" content='Converts genotype data between character string formats (e.g., "AABB", "ABBB") and numeric dosage values
(e.g., 0, 1, 2, 3) based on user-defined reference and alternative alleles. This function is designed to handle
diploid and polyploid genotypes by interpreting the number of occurrences of the alternative allele.
This is especially useful for genotype encodings that represent dosage via string repetition (e.g., "AAAB" → 1 alt allele),
or to reconstruct genotype strings from numeric dosage values (e.g., 0 → "AAAA").'><meta property="og:description" content='Converts genotype data between character string formats (e.g., "AABB", "ABBB") and numeric dosage values
(e.g., 0, 1, 2, 3) based on user-defined reference and alternative alleles. This function is designed to handle
diploid and polyploid genotypes by interpreting the number of occurrences of the alternative allele.
This is especially useful for genotype encodings that represent dosage via string repetition (e.g., "AAAB" → 1 alt allele),
or to reconstruct genotype strings from numeric dosage values (e.g., 0 → "AAAA").'><meta property="og:image" content="https://vegaalfaro.github.io/geneticMapR/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">geneticMapR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/geneticMapR.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/Haplotype_and_Map.html">Genetic Map</a></li>
    <li><a class="dropdown-item" href="../articles/LD_binning.html">Binning SNP Markers</a></li>
    <li><a class="dropdown-item" href="../articles/Linkage_Groups.html">Linkage Groups and Marker Order</a></li>
    <li><a class="dropdown-item" href="../articles/Recode.html">Recode Markers</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/vegaalfaro/geneticMapR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Flexible Genotype Format Converter (Supports Polyploid Dosage)</h1>
      <small class="dont-index">Source: <a href="https://github.com/vegaalfaro/geneticMapR/blob/master/R/formater_flex.R" class="external-link"><code>R/formater_flex.R</code></a></small>
      <div class="d-none name"><code>formater_flex.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Converts genotype data between character string formats (e.g., <code>"AABB"</code>, <code>"ABBB"</code>) and numeric dosage values
(e.g., 0, 1, 2, 3) based on user-defined reference and alternative alleles. This function is designed to handle
diploid and polyploid genotypes by interpreting the number of occurrences of the alternative allele.</p>
<p>This is especially useful for genotype encodings that represent dosage via string repetition (e.g., <code>"AAAB"</code> → 1 alt allele),
or to reconstruct genotype strings from numeric dosage values (e.g., 0 → <code>"AAAA"</code>).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">formater_flex</span><span class="op">(</span></span>
<span>  <span class="va">geno</span>,</span>
<span>  to_numeric <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  ref_allele <span class="op">=</span> <span class="st">"A"</span>,</span>
<span>  alt_allele <span class="op">=</span> <span class="st">"B"</span>,</span>
<span>  ploidy <span class="op">=</span> <span class="fl">2</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-geno">geno<a class="anchor" aria-label="anchor" href="#arg-geno"></a></dt>
<dd><p>A data frame containing genotype values. Values must be either character strings representing genotypes
(e.g., <code>"AAAA"</code>, <code>"AAAB"</code>, <code>"BBBB"</code>), or numeric dosage values (e.g., 0 to <code>ploidy</code>).</p></dd>


<dt id="arg-to-numeric">to_numeric<a class="anchor" aria-label="anchor" href="#arg-to-numeric"></a></dt>
<dd><p>Logical. If <code>TRUE</code>, converts character genotypes to numeric dosage by counting the number of
<code>alt_allele</code> occurrences. If <code>FALSE</code>, reconstructs genotype strings from numeric dosage values using the specified
<code>ref_allele</code> and <code>alt_allele</code>.</p></dd>


<dt id="arg-ref-allele">ref_allele<a class="anchor" aria-label="anchor" href="#arg-ref-allele"></a></dt>
<dd><p>Character. The reference allele. This is used to define the "zero dosage" baseline and for
reconstructing character genotypes from numeric dosage (e.g., "A" in "AAAB").</p></dd>


<dt id="arg-alt-allele">alt_allele<a class="anchor" aria-label="anchor" href="#arg-alt-allele"></a></dt>
<dd><p>Character. The alternative allele. Dosage is computed as the count of this allele in the genotype
string (e.g., "B" in "AAAB" → dosage = 1).</p></dd>


<dt id="arg-ploidy">ploidy<a class="anchor" aria-label="anchor" href="#arg-ploidy"></a></dt>
<dd><p>Integer. Ploidy level of the organism. Only used when <code>to_numeric = FALSE</code> to determine how many
reference and alternative alleles to paste together when reconstructing genotype strings.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A data frame of the same structure as <code>geno</code>, with genotypes converted according to the <code>to_numeric</code> setting.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>

<ul><li><p>When <code>to_numeric = TRUE</code>, all values in <code>geno</code> must be character strings, and the function will count the
number of occurrences of the <code>alt_allele</code> using <code><a href="https://stringr.tidyverse.org/reference/str_count.html" class="external-link">stringr::str_count()</a></code>. Missing values (<code>NA</code>) are preserved.</p></li>
<li><p>When <code>to_numeric = FALSE</code>, all values in <code>geno</code> must be numeric dosages between 0 and <code>ploidy</code>, inclusive.
The function will reconstruct character genotype strings by repeating the <code>ref_allele</code> and <code>alt_allele</code>
the appropriate number of times. For example, with <code>ploidy = 4</code>, a dosage of 2 becomes <code>"AABB"</code>.</p></li>
<li><p>Values outside the expected range (e.g., dosage &gt; ploidy or unknown characters) are converted to <code>NA</code>.</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Example 1: Character to numeric (tetraploid)</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="va">geno</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  Marker1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"AAAA"</span>, <span class="st">"AAAB"</span>, <span class="st">"AABB"</span>, <span class="st">"ABBB"</span>, <span class="st">"BBBB"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  Marker2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"AAAB"</span>, <span class="st">"AABB"</span>, <span class="st">"ABBB"</span>, <span class="st">"BBBB"</span>, <span class="cn">NA</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">formater_flex</span><span class="op">(</span><span class="va">geno</span>, to_numeric <span class="op">=</span> <span class="cn">TRUE</span>, ref_allele <span class="op">=</span> <span class="st">"A"</span>, alt_allele <span class="op">=</span> <span class="st">"B"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span><span class="co"># Example 2: Numeric to character (tetraploid)</span></span></span>
<span class="r-in"><span> <span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="va">dosage</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  Marker1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  Marker2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="cn">NA</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">formater_flex</span><span class="op">(</span><span class="va">dosage</span>, to_numeric <span class="op">=</span> <span class="cn">FALSE</span>, ref_allele <span class="op">=</span> <span class="st">"A"</span>, alt_allele <span class="op">=</span> <span class="st">"B"</span>, ploidy <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Andrey Vega Alfaro.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

