% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/recode.R
\name{recode}
\alias{recode}
\title{Phase Genotype Marker Data Based on Parental References}
\usage{
recode(
  geno,
  parent1,
  parent2,
  numeric_output = TRUE,
  handle_het_markers = FALSE,
  het_marker_types = NULL
)
}
\arguments{
\item{geno}{A genotype matrix or data frame where markers are rows and individuals are columns.}

\item{parent1}{Character. The name of the column representing the first parent.}

\item{parent2}{Character. The name of the column representing the second parent.}

\item{numeric_output}{Logical. If \code{TRUE}, converts phased markers to numeric dosage values
(\code{A = 0}, \code{H = 1}, \code{B = 2}). Default is \code{TRUE}.}

\item{handle_het_markers}{Logical. If \code{TRUE}, allows heterozygous parent markers to be included.
Default is \code{FALSE}.}

\item{het_marker_types}{Character vector. Specifies which heterozygous markers to keep
when \code{handle_het_markers = TRUE}. Options include \code{"AxH"}, \code{"HxB"}, \code{"HxA"}, \code{"BxH"}.
Default is \code{NULL}, meaning all homozygous markers are kept. See details.}
}
\value{
A data frame containing phased genotype markers where:
\itemize{
\item \code{"0"} represents alleles inherited from \code{parent1}.
\item \code{"2"} represents alleles inherited from \code{parent2}.
\item \code{"1"} represents heterozygous alleles.
\item If \code{numeric_output = FALSE},   \code{0}, \code{2}, \code{1}, are replaced by \code{"A"}, \code{"B"}, \code{"H"} respectively.
\item \code{numeric_output = TRUE} is recommended.
}
}
\description{
\code{recode} is the heart of the package. This powerful function phases genotype marker
data based on two parental references (\code{parent1} and \code{parent2}).

It phases markers according to parental allele inheritance.
Optionally, it can code phased markers into numeric (\code{0}, \code{1}, \code{2}) or character (\code{"A"}, \code{"B"}, \code{"H"}) formats.
Numeric coding is recommended for downstream analyses.
}
\details{
\itemize{
\item Drops markers where either parent has \code{NA}.
\item Removes non-polymorphic markers (markers where both parents have the same genotype).
\item If \code{handle_het_markers = FALSE}, retains only homozygous marker where dosages are as follows: (\code{P1 = 0} & \code{P2 = 2} or \code{P1 = 2} & \code{P2 = 0})
\item If \code{handle_het_markers = TRUE}, allows heterozygous markers to be kept.
\item Ensures that \code{parent1} is always \code{0} and specific heterozygous markers to be kept.
\item Ensures that \code{parent1} is always \code{0} and \code{parent2} is always \code{2} for standardization.
\item Returns a numeric matrix if \code{numeric_output = TRUE}, otherwise returns phased \code{"A"}, \code{"B"}, \code{"H"} values.
\item More details on the heterozygous F2 marker types ("AxH", "HxB", "HxA", "BxH") are in \href{https://acsess.onlinelibrary.wiley.com/doi/10.3835/plantgenome2016.10.0110}{Braun et al. (2017).}
}
}
\note{
This function was refined with assistance from ChatGPT to improve clarity,
efficiency, and visualization formatting. Extensive testing was performed by the author to verify outputs.
}
\examples{
# Example genotype data
geno_data <- data.frame(
  Marker1 = c(0, 1, 2, 0, 2),
  Marker2 = c(2, 0, 2, 1, 0),
  Parent1 = c(0, 2, 2, 0, 2),
  Parent2 = c(2, 0, 0, 2, 0)
)

# Recode genotype markers (default: numeric output)
phased_geno <- recode(geno_data, "Parent1", "Parent2")
print(phased_geno)

# Recode genotype markers with heterozygous marker handling
phased_geno_het <- recode(geno_data, "Parent1", "Parent2",
                          handle_het_markers = TRUE,
                          het_marker_types = c("AxH", "HxB"))
print(phased_geno_het)




}
