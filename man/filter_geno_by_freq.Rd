% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/filter_geno_by_freq.R
\name{filter_geno_by_freq}
\alias{filter_geno_by_freq}
\title{Filter Genotype Matrix by Allele Frequency}
\usage{
filter_geno_by_freq(
  geno_matrix,
  max_geno_freq = NULL,
  het_freq_range = NULL,
  min_geno_freq = NULL,
  input_format = "numeric"
)
}
\arguments{
\item{geno_matrix}{A numeric genotype matrix or data frame where:
\itemize{
\item Rows represent genetic markers.
\item Columns represent individuals.
\item Values are either \verb{0, 1, 2} (numeric format) or \verb{"A", "H", "B"} (genotype format).
}}

\item{max_geno_freq}{Numeric. If provided, removes markers where the most frequent
genotype exceeds this threshold.}

\item{het_freq_range}{Numeric vector of length 2. If provided, retains markers where
heterozygosity frequency is within the specified range (\code{c(min, max)}).}

\item{min_geno_freq}{Numeric. If provided, removes markers where the least frequent
genotype falls below this threshold.}

\item{input_format}{Character. Specifies whether the genotype matrix is in \code{"numeric"}
(\verb{0, 1, 2}) or \code{"genotype"} (\verb{"A", "H", "B"}) format. Default is \code{"numeric"}.}
}
\value{
A filtered genotype matrix with only markers that meet the specified
frequency criteria.
}
\description{
Filters a genotype matrix by applying constraints on the maximum
and minimum genotype frequency per marker, as well as heterozygous frequency.
The filtering is based on allele frequency calculations using the \code{freq()} function internally.
}
\details{
\itemize{
\item Computes genotype frequencies using the \code{freq()} function.
\item Retains only markers that meet the specified frequency constraints.
\item If all filtering parameters (\code{max_geno_freq}, \code{het_freq_range}, \code{min_geno_freq}) are \code{NULL},
the function returns the original matrix.
}
}
\examples{
# Example genotype matrix
geno_data <- matrix(sample(0:2, 30, replace = TRUE),
                    nrow = 10, ncol = 3,
                    dimnames = list(paste0("Marker", 1:10), paste0("Ind", 1:3)))

# Filter markers with max genotype frequency < 0.95, heterozygosity between 0.1 and 0.8,
# and minimum genotype frequency >= 0.05
filtered_data <- filter_geno_by_freq(geno_data, max_geno_freq = 0.95,
                                     het_freq_range = c(0.1, 0.80), min_geno_freq = 0.05)


}
