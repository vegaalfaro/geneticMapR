% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/convert_to_dosage_flex.R
\name{convert_to_dosage_flex}
\alias{convert_to_dosage_flex}
\title{Convert VCF Genotype Format to Dosage (Supports Polyploids and Missing Alleles)}
\usage{
convert_to_dosage_flex(GT, strict_missing = TRUE)
}
\arguments{
\item{GT}{A character matrix with genotypes in VCF format (e.g., "0/1/1/1", "1/1/1/1").}

\item{strict_missing}{Logical. If TRUE (default), any missing allele (e.g., ".") causes the entire genotype to be set as NA.
If FALSE, missing alleles are ignored and dosage is calculated from the available alleles.}
}
\value{
A numeric matrix with the same dimensions and names as \code{GT}, where each value is the
dosage of the alternate allele (assumed to be "1").
}
\description{
Converts a VCF genotype matrix (in the GT format e.g., "0/0", or for poplyplids "0/0/1/1") into numeric dosage values representing
the count of alternate alleles. Works with any ploidy (\emph{but tested only from haploid to hexaploid}) and allows control over how missing
alleles (".") are handled.
}
\details{
\itemize{
\item This function is flexible for any ploidy level — it simply counts how many \code{"1"} alleles exist in each genotype.
\item Alleles are split using either \code{/} or \code{|}, so phased or unphased VCF data are supported.
\item Missing alleles (\code{"."}) are handled based on the \code{strict_missing} argument:
\itemize{
\item \code{TRUE}: If \emph{any} allele is missing in a genotype, the entire dosage is returned as \code{NA}.
\item \code{FALSE}: Missing alleles are ignored and dosage is calculated from known alleles.
}
}
}
\examples{
poly_vcf <- matrix(c("0/0/0/0", "1/1/1/1", "0/1/1/1",
                     "1/1/1/1", NA, "0/1/./1"),
                   nrow = 2, byrow = TRUE,
                   dimnames = list(c("Marker1", "Marker2"),
                                   c("Ind1", "Ind2", "Ind3")))

# Strict handling: missing allele causes full NA
convert_to_dosage_flex(poly_vcf, strict_missing = TRUE)   # Set whole cell to NA if "." present

# Permissive handling: ignore missing and sum known alleles
convert_to_dosage_flex(poly_vcf, strict_missing = FALSE)  # Ignore "." and sum what’s there

}
