% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/formater_flex.R
\name{formater_flex}
\alias{formater_flex}
\title{Flexible Genotype Format Converter (Supports Polyploid Dosage)}
\usage{
formater_flex(
  geno,
  to_numeric = TRUE,
  ref_allele = "A",
  alt_allele = "B",
  ploidy = 2
)
}
\arguments{
\item{geno}{A data frame containing genotype values. Values must be either character strings representing genotypes
(e.g., \code{"AAAA"}, \code{"AAAB"}, \code{"BBBB"}), or numeric dosage values (e.g., 0 to \code{ploidy}).}

\item{to_numeric}{Logical. If \code{TRUE}, converts character genotypes to numeric dosage by counting the number of
\code{alt_allele} occurrences. If \code{FALSE}, reconstructs genotype strings from numeric dosage values using the specified
\code{ref_allele} and \code{alt_allele}.}

\item{ref_allele}{Character. The reference allele. This is used to define the "zero dosage" baseline and for
reconstructing character genotypes from numeric dosage (e.g., "A" in "AAAB").}

\item{alt_allele}{Character. The alternative allele. Dosage is computed as the count of this allele in the genotype
string (e.g., "B" in "AAAB" → dosage = 1).}

\item{ploidy}{Integer. Ploidy level of the organism. Only used when \code{to_numeric = FALSE} to determine how many
reference and alternative alleles to paste together when reconstructing genotype strings.}
}
\value{
A data frame of the same structure as \code{geno}, with genotypes converted according to the \code{to_numeric} setting.
}
\description{
Converts genotype data between character string formats (e.g., \code{"AABB"}, \code{"ABBB"}) and numeric dosage values
(e.g., 0, 1, 2, 3) based on user-defined reference and alternative alleles. This function is designed to handle
diploid and polyploid genotypes by interpreting the number of occurrences of the alternative allele.

This is especially useful for genotype encodings that represent dosage via string repetition (e.g., \code{"AAAB"} → 1 alt allele),
or to reconstruct genotype strings from numeric dosage values (e.g., 0 → \code{"AAAA"}).
}
\details{
\itemize{
\item When \code{to_numeric = TRUE}, all values in \code{geno} must be character strings, and the function will count the
number of occurrences of the \code{alt_allele} using \code{stringr::str_count()}. Missing values (\code{NA}) are preserved.
\item When \code{to_numeric = FALSE}, all values in \code{geno} must be numeric dosages between 0 and \code{ploidy}, inclusive.
The function will reconstruct character genotype strings by repeating the \code{ref_allele} and \code{alt_allele}
the appropriate number of times. For example, with \code{ploidy = 4}, a dosage of 2 becomes \code{"AABB"}.
\item Values outside the expected range (e.g., dosage > ploidy or unknown characters) are converted to \code{NA}.
}
}
\examples{
# Example 1: Character to numeric (tetraploid)
\dontrun{
geno <- data.frame(
  Marker1 = c("AAAA", "AAAB", "AABB", "ABBB", "BBBB"),
  Marker2 = c("AAAB", "AABB", "ABBB", "BBBB", NA)
)
formater_flex(geno, to_numeric = TRUE, ref_allele = "A", alt_allele = "B")
}
# Example 2: Numeric to character (tetraploid)
 \dontrun{
dosage <- data.frame(
  Marker1 = c(0, 1, 2, 3, 4),
  Marker2 = c(1, 2, 3, 4, NA)
)
formater_flex(dosage, to_numeric = FALSE, ref_allele = "A", alt_allele = "B", ploidy = 4)
}
}
